{% extends 'user_template/my_event_dashboard.html' %}

{% block extra_style %}
{% endblock %}


{% block body %}
<main class="main_min_heg">
    <div class="container">
        <div class="row mt-3 mb-3 justify-content-center align-items-center  position-relative">
            <div class="col-md-6">
                <h4 class="mb-0">Potential Event Member ({{instance_EventGroupMembers|length}})</h4>
            </div>
        <div class="col-md-6 text-right position_unset">
          <div class="navbar justify-content-end position_unset">
            <ul class="Campaign_action_right  navbar-nav position_unset">
                <li class="nav-item"  id="download"></li>
                <li class="nav-item"  id="print-assets"></li>    
                <li class="nav-item dropdown mr-4 right_zero position_unset"><a class="nav-link dropdown-toggle " href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false"><i aria-hidden="true" class="fa fa-th" aria-hidden="true"></i></a>
                            <div class="dropdown-menu dropdown-menu-right " aria-labelledby="navbarDropdown">
                                <div class="container-fluid">
                                  <form class="view_grid_styled-checkbox">
                                    <p>Show Columns</p>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="0" id="filter-checkbox-1"  />
                                          <label for="filter-checkbox-1">Date Time</label>
                                      </div>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="1"  id="filter-checkbox-2"  />
                                          <label for="filter-checkbox-2">Name</label>
                                      </div>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="2" id="filter-checkbox-3" />
                                          <label for="filter-checkbox-3">Email</label>
                                      </div>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="3" id="filter-checkbox-4" />
                                          <label for="filter-checkbox-4">Mobile No</label>
                                      </div>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="4" id="filter-checkbox-5" />
                                          <label for="filter-checkbox-5">City</label>
                                      </div>
                                      <div>
                                          <input type="checkbox" class="styled-checkbox mr-2" checked data-column="5" id="filter-checkbox-6" />
                                          <label for="filter-checkbox-6">Action</label>
                                      </div>
                                  </form>
                                </div>
                      
                              </div>
                          </li>  
                <li class="nav-item dropdown mr-4 right_zero position_unset">
                    <a class="nav-link dropdown-toggle " href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                      aria-haspopup="true" aria-expanded="false">
                      <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        x="0px" y="0px" width="18px" height="18px" viewBox="0 0 459 459" style="enable-background:new 0 0 459 459;"
                        xml:space="preserve">
                        <g>
                          <g id="filter">
                            <path d="M178.5,382.5h102v-51h-102V382.5z M0,76.5v51h459v-51H0z M76.5,255h306v-51h-306V255z" />
                          </g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                        <g>
                        </g>
                      </svg>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right w-100" aria-labelledby="navbarDropdown">
                      <div class="container-fluid">
                        <form >
                          <div class="row">
                          <div class="col-sm-12">
                            <h5 class="mb-0">Filters <span><button type="clear" class="colr_yellow btn_none"><span
                                    class="jss237 jss231" style="font-size: 15px;">Reset</span></button></span></h5>
            
                          </div>    
                        </div>
                        <div class="d-flex w-100 new_contaniner_dropdown">                                  
                            <div class="jss550 jss551 ">
                              <div class="jss550">
                                <div class="">
                                    <p class="jss798 jss807 mb-2">Date Time</p>
                                    {% for supporter in instance_EventGroupMembers %}
                                  <div>                                           
                                    <input type="checkbox" class="styled-checkbox" id="filter-checkbox-date-{{supporter.id}}" name="Date" onchange="filterme()"
                                      value="{{supporter.created_at}}" class="mr-2" />
                                    <label for="filter-checkbox-date-{{supporter.id}}">{{supporter.created_at}}</label>
                                  </div>
                                  {% endfor %}
                                  
                                </div>
                              </div>
                            </div>
                            <div class="jss550 jss551 ">
                              <div class="jss550">
                                <div class="">
                                  <p class="jss798 jss807 mb-2">Name</p>
                                  {% for supporter in instance_EventGroupMembers %}
                                  <div>                                            
                                    <input type="checkbox" class="styled-checkbox" id="filter-checkbox-name-{{supporter.id}}" name="Name" onchange="filterme()"
                                      value="{{supporter.name}}" class="mr-2" />
                                    <label for="filter-checkbox-name-{{supporter.id}}">{{supporter.name}}</label>
                                  </div>
                                  {% endfor %}
                                </div>
                              </div>
                            </div>
                            <div class="jss550 jss551 ">
                              <div class="jss550">
                                <div class="">
                                  <p class="jss798 jss807 mb-2">Email</p>
                                  {% for supporter in instance_EventGroupMembers %}
                                  <div>                                            
                                    <input type="checkbox" class="styled-checkbox" id="filter-checkbox-email-{{supporter.id}}" name="Email" onchange="filterme()"
                                      value="{{supporter.email}}" class="mr-2" />
                                    <label for="filter-checkbox-email-{{supporter.id}}">{{supporter.email}}</label>
                                  </div>
                                  {% endfor %}
                                </div>
                              </div>
                            </div>
                            <div class="jss550 jss551 ">
                              <div class="jss550">
                                <div class="">
                                  <p class="jss798 jss807 mb-2">Mobile No</p>
                                  {% for supporter in instance_EventGroupMembers %}
                                  <div>                                            
                                    <input type="checkbox" class="styled-checkbox" id="filter-checkbox-phone-{{supporter.id}}" name="Mobile No" onchange="filterme()"
                                      value="{{supporter.phone}}" class="mr-2" />
                                    <label for="filter-checkbox-phone-{{supporter.id}}">{{supporter.phone}}</label>
                                  </div>
                                  {% endfor %}
                                </div>
                              </div>
                            </div>
                          </div>
                        </form>
                      </div>
            
                    </div>
                  </li>      
            </ul>
          </div>
        </div>
        </div>

        <div class="table_parent">
          <table class="table text-center w-100 " id="donor_table">
              <thead class="thead-light">
                <tr>


                  <th scope="col">Date Time</th>
                  <th scope="col">Name </th>
                  <th scope="col">Email</th>
                  <th scope="col">Mobile No</th>
                  <th scope="col">City</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for supporter in instance_EventGroupMembers %}
                <tr>
                    <td>{{supporter.created_at}}</td>
                    <td>{{supporter.name}}</td>
                    <td>{{supporter.email}}</td>
                    <td>{{supporter.phone}}</td>
                    <td>{{supporter.city}}</td>
                    <td><a href="{% url 'my_event_campaign_supporter_reminder' id=supporter.id %}"><button class="jss144 btn_none"> <i class="fa fa-bell" aria-hidden="true"></i> Send Remainder </button> </a></td>
                </tr>
                {% endfor %}
              </tbody>
            </table>         
        </div>       
        </div>
  </main>
{% endblock %}

{% block extra_script %}

<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js" ></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js" ></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" ></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js" ></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js" ></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js" ></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js" ></script>


<script>
    $('#print-assets').empty();
  $( '#download' ).empty();
  

  dt = $('#donor_table').DataTable();
  
    new $.fn.DataTable.Buttons( dt, {
        buttons: [
            {
                text: '<i class="fa fa-cloud-download"></i>',
                extend: 'excel',
                extension: '.xls'
            }
        ]
    } );

    // Add the Export buttons to the toolbox
    dt.buttons( 0, null ).container().appendTo( '#download' );      
    
    // Configure Print Button
    new $.fn.DataTable.Buttons( dt , {
        buttons: [
            {
                text: '<i class="fa fa-print"></i>',
                extend: 'print'
            }
        ]
    } );  
   
    // Add the Print button to the toolbox
    dt.buttons( 1, null ).container().appendTo( '#print-assets' );


    $('.styled-checkbox').on( 'change', function (e) {
        // e.preventDefault();   
        // Get the column API object
        var column = dt.column( $(this).attr('data-column') );
 
        // Toggle the visibility
        column.visible( ! column.visible() );
    } );

    $(".view_grid_styled-checkbox .styled-checkbox").each(function( index ) {
          if($( this ).prop("checked") == false){
             
                   // Get the column API object
                   var column = dt.column( $(this).attr('data-column') );
     
                   // Toggle the visibility
                   column.visible( ! column.visible() );
                 }
        });

      tdt = $('#donor_table').dataTable();
 

    function filterme() {
      //build a regex filter string with an or(|) condition
      var Dates = $('input:checkbox[name="Date"]:checked').map(function() {
        return '^' + this.value + '\$';
      }).get().join('|');
      //filter in column 0, with an regex, no smart filtering, no inputbox,not case sensitive
      tdt.fnFilter(Dates, 0, true, false, false, false);

      //build a regex filter string with an or(|) condition
      var Names = $('input:checkbox[name="Name"]:checked').map(function() {
        return '^' + this.value + '\$';
      }).get().join('|');
      //filter in column 0, with an regex, no smart filtering, no inputbox,not case sensitive
      tdt.fnFilter(Names, 1, true, false, false, false);

      //build a filter string with an or(|) condition
      var Emails = $('input:checkbox[name="Email"]:checked').map(function() {
        return '^' + this.value + '\$';
      }).get().join('|');
      //now filter in column 2, with no regex, no smart filtering, no inputbox,not case sensitive
      tdt.fnFilter(Emails, 2, true, false, false, false);

      //build a filter string with an or(|) condition
      var Sents = $('input:checkbox[name="Sent"]:checked').map(function() {
        return this.value;
      }).get().join('|');
      //now filter in column 4, with no regex, no smart filtering, no inputbox,not case sensitive
      tdt.fnFilter(Sents, 4, false, false, true, false);

      //build a filter string with an or(|) condition
      var Mobile_No = $('input:checkbox[name="Mobile No"]:checked').map(function() {
        return this.value;
      }).get().join('|');
      //now filter in column 3, with no regex, no smart filtering, no inputbox,not case sensitive
      tdt.fnFilter(Mobile_No, 3, false, false, true, false);
    }


</script>
{% endblock %}